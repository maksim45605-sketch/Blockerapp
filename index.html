<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–†–ö–ù –†—É–ª–µ—Ç–∫–∞</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="static/css/styles.css" />

  <!-- –ö—Ä–∞—Å–∏–≤—ã–π UI –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å —Ç—É—Ç, —á—Ç–æ–±—ã –Ω–µ —Ç—Ä–æ–≥–∞—Ç—å styles.css) -->
  <style>
    :root{
      --glass: rgba(255,255,255,.08);
      --glass2: rgba(255,255,255,.12);
      --stroke: rgba(255,255,255,.14);
      --shadow: 0 18px 60px rgba(0,0,0,.35);
      --radius: 16px;
    }

    /* –ö–Ω–æ–ø–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è –≤ —É–≥–ª—É */
    .profile-fab{
      position: fixed;
      top: 16px;
      right: 16px;
      z-index: 9999;
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      border-radius: 999px;
      background: linear-gradient(180deg, var(--glass2), var(--glass));
      border: 1px solid var(--stroke);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      cursor: pointer;
      user-select: none;
    }
    .profile-fab:hover{ transform: translateY(-1px); }
    .profile-fab:active{ transform: translateY(0); }

    .avatar-badge{
      width: 36px;
      height: 36px;
      border-radius: 999px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size: 18px;
      background: rgba(0,0,0,.22);
      border: 1px solid var(--stroke);
    }
    .fab-text{
      display:flex;
      flex-direction: column;
      line-height: 1.05;
    }
    .fab-title{ font-weight: 700; font-size: 12px; opacity: .9; }
    .fab-sub{ font-size: 11px; opacity: .75; }

    /* –ú–æ–¥–∞–ª–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è */
    .profile-overlay{
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,.55);
      display: none;
      z-index: 9998;
    }
    .profile-overlay.show{ display: block; }

    .profile-modal{
      position: fixed;
      top: 70px;
      right: 16px;
      width: min(420px, calc(100vw - 32px));
      background: linear-gradient(180deg, rgba(30,30,30,.78), rgba(20,20,20,.62));
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      padding: 14px;
      display: none;
      z-index: 9999;
      color: rgba(255,255,255,.92);
    }
    .profile-modal.show{ display: block; }

    .pm-head{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 10px;
      margin-bottom: 10px;
    }
    .pm-title{
      font-size: 14px;
      font-weight: 700;
      opacity: .95;
    }
    .pm-close{
      width: 34px;
      height: 34px;
      border-radius: 12px;
      border: 1px solid var(--stroke);
      background: rgba(255,255,255,.06);
      color: rgba(255,255,255,.9);
      cursor:pointer;
    }

    .pm-card{
      background: rgba(255,255,255,.06);
      border: 1px solid var(--stroke);
      border-radius: 14px;
      padding: 12px;
      margin-top: 10px;
    }

    .row{ display:flex; gap: 10px; flex-wrap: wrap; }
    .row > *{ flex: 1; min-width: 140px; }

    .pm-label{ font-size: 12px; opacity: .75; margin-bottom: 6px; }
    .pm-value{ font-size: 14px; font-weight: 700; }

    .pm-input{
      width: 100%;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.25);
      color: rgba(255,255,255,.92);
      outline: none;
    }

    .pm-btn{
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.08);
      color: rgba(255,255,255,.92);
      cursor: pointer;
      font-weight: 700;
    }
    .pm-btn:hover{ background: rgba(255,255,255,.12); }

    .pm-btn.primary{
      background: linear-gradient(180deg, rgba(255,90,90,.32), rgba(255,90,90,.16));
      border-color: rgba(255,90,90,.35);
    }

    .emoji-grid{
      display:flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 8px;
    }
    .emoji-btn{
      width: 42px;
      height: 42px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.22);
      cursor:pointer;
      font-size: 18px;
    }
    .emoji-btn:hover{ background: rgba(255,255,255,.08); }

    .hint{
      font-size: 12px;
      opacity: .75;
      margin-top: 8px;
      line-height: 1.25;
    }
  </style>
</head>

<body>
  <!-- Header -->
  <header>
    <div class="header-inner">
      <img src="static/img/RKN.png" alt="–õ–æ–≥–æ—Ç–∏–ø –†–ö–ù" class="rkn-logo">
      <div class="header-text">
        <div class="rkn-title">–†–æ—Å–∫–æ–º–Ω–∞–¥–∑–æ—Ä</div>
        <div class="rkn-subtitle">–§–µ–¥–µ—Ä–∞–ª—å–Ω–∞—è —Å–ª—É–∂–±–∞ –ø–æ –Ω–∞–¥–∑–æ—Ä—É –≤ —Å—Ñ–µ—Ä–µ —Å–≤—è–∑–∏</div>
      </div>
    </div>
  </header>

  <!-- –ö–Ω–æ–ø–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è –≤ —É–≥–ª—É -->
  <button class="profile-fab" id="profileFab" type="button" aria-label="–ü—Ä–æ—Ñ–∏–ª—å">
    <div class="avatar-badge" id="avatarBadge">üë§</div>
    <div class="fab-text">
      <div class="fab-title">–ü—Ä–æ—Ñ–∏–ª—å</div>
      <div class="fab-sub">–ë–∞–ª–∞–Ω—Å: <span id="balanceMini">0 ‚ÇΩ</span></div>
    </div>
  </button>

  <!-- Overlay + Profile modal -->
  <div class="profile-overlay" id="profileOverlay"></div>

  <div class="profile-modal" id="profileModal">
    <div class="pm-head">
      <div class="pm-title">–ê–∫–∫–∞—É–Ω—Ç</div>
      <button class="pm-close" id="profileClose" type="button">‚úï</button>
    </div>

    <!-- VIEW: Logged out -->
    <div id="authView" class="pm-card">
      <div class="pm-label">–í–æ–π—Ç–∏, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤–∞–ª—é—Ç—É</div>

      <div class="row" style="margin-top:8px;">
        <button class="pm-btn primary" id="googleLoginBtn" type="button">–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google</button>
      </div>

      <div class="pm-label" style="margin-top:12px;">–ò–ª–∏ Email + –ø–∞—Ä–æ–ª—å</div>
      <div class="row">
        <input class="pm-input" id="email" type="email" placeholder="Email">
        <input class="pm-input" id="password" type="password" placeholder="–ü–∞—Ä–æ–ª—å">
      </div>

      <div class="row" style="margin-top:8px;">
        <button class="pm-btn" id="emailRegisterBtn" type="button">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
        <button class="pm-btn" id="emailLoginBtn" type="button">–í—Ö–æ–¥</button>
      </div>

      <div class="hint">Email –Ω–∏–≥–¥–µ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ ‚Äî —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –ø—Ä–æ—Ñ–∏–ª—è.</div>
    </div>

    <!-- VIEW: Logged in -->
    <div id="accountView" class="pm-card" style="display:none;">
      <div class="row" style="align-items:center;">
        <div style="display:flex;gap:10px;align-items:center;">
          <div class="avatar-badge" style="width:44px;height:44px;font-size:20px;" id="avatarBig">üôÇ</div>
          <div>
            <div class="pm-label">–ë–∞–ª–∞–Ω—Å</div>
            <div class="pm-value"><span id="balanceLabel">0 ‚ÇΩ</span></div>
          </div>
        </div>
        <div style="display:flex;justify-content:flex-end;gap:8px;">
          <button class="pm-btn" id="logoutBtn" type="button">–í—ã–π—Ç–∏</button>
        </div>
      </div>

      <div class="pm-label" style="margin-top:12px;">–ê–≤–∞—Ç–∞—Ä (—ç–º–æ–¥–∂–∏)</div>
      <div class="row">
        <input class="pm-input" id="avatarInput" type="text" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: üòé" maxlength="8">
        <button class="pm-btn primary" id="saveAvatarBtn" type="button">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      </div>

      <div class="emoji-grid" id="emojiGrid">
        <button class="emoji-btn" type="button" data-emoji="üòé">üòé</button>
        <button class="emoji-btn" type="button" data-emoji="üïµÔ∏è">üïµÔ∏è</button>
        <button class="emoji-btn" type="button" data-emoji="ü§°">ü§°</button>
        <button class="emoji-btn" type="button" data-emoji="üß†">üß†</button>
        <button class="emoji-btn" type="button" data-emoji="üêô">üêô</button>
        <button class="emoji-btn" type="button" data-emoji="üî•">üî•</button>
        <button class="emoji-btn" type="button" data-emoji="üíº">üíº</button>
        <button class="emoji-btn" type="button" data-emoji="üß±">üß±</button>
      </div>

      <div class="pm-card" style="margin-top:10px;">
        <div class="pm-label">–ü—Ä–æ—Ñ–∏–ª—å (—Ç—É—Ç –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å email)</div>
        <div class="pm-value" id="profileEmail">‚Äî</div>
      </div>
    </div>
  </div>

  <!-- Main -->
  <main>
    <h1>–ß–¢–û –ó–ê–ü–†–ï–¢–ò–ú –°–ï–ì–û–î–ù–Ø?</h1>

    <div class="roulette-container">
      <div class="pointer"></div>
      <div class="roulette-track" id="track"></div>
    </div>

    <button class="spin-btn" id="spinBtn">–ö–†–£–¢–ò–¢–¨</button>
  </main>

  <!-- Modal roulette -->
  <div class="modal-overlay" id="modalOverlay">
    <div class="modal-window" id="modalWindow">

      <div id="actionStep">
        <img src="" alt="Service Logo" class="modal-img" id="modalImg">
        <div class="modal-title" id="modalTitle">Service</div>

        <div class="action-buttons">
          <button class="rkn-btn btn-restrict" onclick="applyPunishment('–û–ì–†–ê–ù–ò–ß–ï–ù–û')">–û–≥—Ä–∞–Ω–∏—á–∏—Ç—å</button>
          <button class="rkn-btn btn-slow" onclick="applyPunishment('–ó–ê–ú–ï–î–õ–ï–ù–û')">–ó–∞–º–µ–¥–ª–∏—Ç—å</button>
          <button class="rkn-btn btn-ban" onclick="applyPunishment('–ó–ê–ë–ê–ù–ï–ù–û')">–ó–ê–ë–ê–ù–ò–¢–¨</button>
        </div>
      </div>

      <div id="resultStep" class="result-view">
        <div class="result-status" id="statusText">–ó–ê–ë–ê–ù–ï–ù–û</div>
        <div class="good-job">–°–µ–≥–æ–¥–Ω—è –≤—ã —Ö–æ—Ä–æ—à–æ –ø–æ—Ç—Ä—É–¥–∏–ª–∏—Å—å</div>
        <div class="salary" id="salaryAmount">0 ‚ÇΩ</div>
        <div class="salary-label">–≤–∞—à–∞ –∑–∞—Ä–ø–ª–∞—Ç–∞ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è</div>

        <button class="result-btn btn-take" onclick="takeMoney()">–ó–∞–±—Ä–∞—Ç—å –¥–µ–Ω—å–≥–∏</button>
        <button class="result-btn btn-again" onclick="resetRoulette()">–ö—Ä—É—Ç–∏—Ç—å –µ—â—ë</button>
      </div>

    </div>
  </div>

  <!-- Firebase -->
  <script type="module" src="static/js/firebase-init.js"></script>
  <script type="module" src="static/js/auth.js"></script>
  <script type="module" src="static/js/wallet.js"></script>
  <script type="module" src="static/js/script.js"></script>
</body>
</html>
